<!doctype html>
<html lang="en">
  <head>
    <title>GeoDataToolkit :: Sensors</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

    <style>
        .chart-container {
          width: 100%;
          height: auto;
        }
      </style>
  </head>
  <body>
      
    <div class="container-fluid">
        <div class="row">
            <div class="col">
                <div class="jumbotron">
                    <h1 class="display-4">GeoDataToolkit</h1>
                    <p class="lead">
                        Charts for sensors data.
                    </p>
                    <hr class="my-4">
                  </div>
            
            </div>
        </div>
        <div class="row">
            <div class="col">
                    <div class="card">
                        Sensor 1
                        <br/>
                        <div class="chart-container">
                            <canvas id="mycanvas1"></canvas>
                          </div>
                    </div>
            </div>
            <div class="col">
             
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="card">
                    Sensor 3
                    <br/>
                    <div class="chart-container">
                        <canvas id="mycanvas3"></canvas>
                      </div>                    
                </div>
            </div>
            <div class="col">
                <div class="card">
                    Sensor 4
                    <br/>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="card">
                    Sensor 2
                    <br/>
                    <div class="chart-container">
                        <canvas id="mycanvas2"></canvas>
                      </div>                    
                </div>
            </div>
        </div>
    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
    <script type="text/javascript">
    $(document).ready(function(){
        //var $j = jQuery.noConflict();
        $.get('/api/sensor/1').done(function(data){
                    console.log(data);
                    var dates=[];
                    var values=[];
                    for(var i=0;i<data.length;i++){
                        values.push(data[i].value);
                        dates.push(data[i].date);    
                    }

                    var chartdata={
                        labels:dates,
                        datasets:[
                                {
                                    label:"Sensor 1",
                                    fill: false,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(29, 202, 255, 0.75)",
                                    borderColor: "rgba(29, 202, 255, 1)",
                                    pointHoverBackgroundColor: "rgba(29, 202, 255, 1)",
                                    pointHoverBorderColor: "rgba(29, 202, 255, 1)",
                                    data: values
                                }
                        ]
                    };
                    var ctx = $("#mycanvas1");

                    var LineGraph = new Chart(ctx, {
                        type: 'line',
                        data: chartdata
                    });

        }).fail(function(data){
                console.log("ERROR");
                console.log(data);
            });

            $.get('/api/sensor/2').done(function(data){
                    console.log(data);
                    var dates=[];
                    var widths=[];
                    var lengths=[];
                    var gpstimes=[];
                    for(var i=0;i<data.length;i++){
                        widths.push(data[i].wide);
                        lengths.push(data[i].lenght);
                        gpstimes.push(data[i].GPStime);
                        dates.push(data[i].date);    
                    }

                    var chartdata={
                        labels:dates,
                        datasets:[
                        {
                                    label:"GPS time",
                                    fill: true,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(211, 72, 54, 0.75)",
                                    borderColor: "rgba(211, 72, 54, 1)",
                                    pointHoverBackgroundColor: "rgba(211, 72, 54, 1)",
                                    pointHoverBorderColor: "rgba(211, 72, 54, 1)",
                                    data: gpstimes
                                },
                                {
                                    label:"width",
                                    fill: false,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(59, 89, 152, 0.75)",
                                    borderColor: "rgba(59, 89, 152, 1)",
                                    pointHoverBackgroundColor: "rgba(59, 89, 152, 1)",
                                    pointHoverBorderColor: "rgba(59, 89, 152, 1)",
                                    data: widths
                                },
                                {
                                    label:"length",
                                    fill: false,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(29, 202, 255, 0.75)",
                                    borderColor: "rgba(29, 202, 255, 1)",
                                    pointHoverBackgroundColor: "rgba(29, 202, 255, 1)",
                                    pointHoverBorderColor: "rgba(29, 202, 255, 1)",
                                    data: lengths
                                }
                             
                        ]
                    };
                    var ctx = $("#mycanvas2");

                    var LineGraph = new Chart(ctx, {
                        type: 'line',
                        data: chartdata
                    });

        }).fail(function(data){
                console.log("ERROR");
                console.log(data);
            });

        $.get('/api/sensor/3').done(function(data){
                    console.log(data);
                    var dates=[];
                    var values=[];
                    for(var i=0;i<data.length;i++){
                        values.push(data[i].value);
                        dates.push(data[i].date);    
                    }

                    var chartdata={
                        labels:dates,
                        datasets:[
                                {
                                    label:"Sensor 3",
                                    fill: false,
                                    lineTension: 0.1,
                                    backgroundColor: "rgba(29, 202, 255, 0.75)",
                                    borderColor: "rgba(29, 202, 255, 1)",
                                    pointHoverBackgroundColor: "rgba(29, 202, 255, 1)",
                                    pointHoverBorderColor: "rgba(29, 202, 255, 1)",
                                    data: values
                                }
                        ]
                    };
                    var ctx = $("#mycanvas3");

                    var LineGraph = new Chart(ctx, {
                        type: 'line',
                        data: chartdata
                    });

        }).fail(function(data){
                console.log("ERROR");
                console.log(data);
            });                        

    });
        
    </script>
  </body>
</html>